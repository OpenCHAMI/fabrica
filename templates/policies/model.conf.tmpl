# SPDX-FileCopyrightText: Copyright Â© 2025 OpenCHAMI a Series of LF Projects, LLC
#
# SPDX-License-Identifier: MIT
# Casbin RBAC Model for Fabrica
# Generated by Fabrica - customize as needed
#
# This model defines Role-Based Access Control (RBAC) for your API resources.
# For more information: https://casbin.org/docs/syntax-for-models

[request_definition]
# r = subject, object, action
# subject: user ID from JWT (auth.UserID)
# object: resource type (e.g., "Device", "User")
# action: operation (list, get, create, update, delete)
r = sub, obj, act

[policy_definition]
# p = subject, object, action
# Defines what a subject (user/role) can do on an object
p = sub, obj, act

[role_definition]
# g = user, role
# Defines role inheritance (user -> role mapping)
g = _, _

[policy_effect]
# Allow if any matching policy allows
e = some(where (p.eft == allow))

[matchers]
# Match if:
# - User has the role (g function handles role inheritance)
# - Resource type matches
# - Action matches
m = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act
